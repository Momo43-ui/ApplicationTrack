import { useState } from 'react'; import { ChevronLeft, ChevronRight, Calendar as CalendarIcon } from 'lucide-react'; export default function CalendarView({ jobs, onViewJob, onBack }) { const [currentDate, setCurrentDate] = useState(new Date()); const getDaysInMonth = (date) => { const year = date.getFullYear(); const month = date.getMonth(); const firstDay = new Date(year, month, 1); const lastDay = new Date(year, month + 1, 0); const daysInMonth = lastDay.getDate(); const startingDayOfWeek = firstDay.getDay(); return { daysInMonth, startingDayOfWeek, year, month }; }; const getJobsForDate = (date) => { const dateStr = date.toISOString().split('T')[0]; return jobs.filter(job => { const jobDate = job.date; const rappelDate = job.rappel_date ? new Date(job.rappel_date).toISOString().split('T')[0] : null; return jobDate === dateStr || rappelDate === dateStr; }); }; const { daysInMonth, startingDayOfWeek, year, month } = getDaysInMonth(currentDate); const monthNames = [ 'Janvier', 'FÃ©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'AoÃ»t', 'Septembre', 'Octobre', 'Novembre', 'DÃ©cembre' ]; const dayNames = ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam']; const previousMonth = () => { setCurrentDate(new Date(year, month - 1, 1)); }; const nextMonth = () => { setCurrentDate(new Date(year, month + 1, 1)); }; const today = new Date(); today.setHours(0, 0, 0, 0); return ( <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100"> <header className="bg-white shadow-md"> <div className="max-w-7xl mx-auto px-4 py-4 md:py-6"> <button onClick={onBack} className="flex items-center gap-2 text-blue-600 hover:text-blue-800 font-semibold text-base md:text-lg transition-colors" > â† Retour </button> </div> </header> <main className="max-w-7xl mx-auto px-4 py-4 md:py-8"> <div className="bg-white rounded-lg shadow-lg p-4 md:p-6"> {/* En-tÃªte du calendrier */} <div className="flex items-center justify-between mb-6"> <h2 className="text-xl md:text-3xl font-bold text-gray-900 flex items-center gap-2"> <CalendarIcon className="text-blue-600" size={32} /> Calendrier des candidatures </h2> <div className="flex items-center gap-4"> <button onClick={previousMonth} className="p-2 hover:bg-gray-100:bg-gray-700 rounded-lg transition-colors" > <ChevronLeft size={24} /> </button> <span className="text-lg md:text-2xl font-bold text-gray-900 min-w-[200px] text-center"> {monthNames[month]} {year} </span> <button onClick={nextMonth} className="p-2 hover:bg-gray-100:bg-gray-700 rounded-lg transition-colors" > <ChevronRight size={24} /> </button> </div> </div> {/* LÃ©gende */} <div className="flex flex-wrap gap-4 mb-4 text-sm"> <div className="flex items-center gap-2"> <div className="w-4 h-4 bg-blue-200 rounded"></div> <span className="text-gray-700">Candidature</span> </div> <div className="flex items-center gap-2"> <div className="w-4 h-4 bg-red-200 rounded"></div> <span className="text-gray-700">Rappel</span> </div> <div className="flex items-center gap-2"> <div className="w-4 h-4 bg-green-200 rounded"></div> <span className="text-gray-700">AcceptÃ©</span> </div> </div> {/* Grille du calendrier */} <div className="grid grid-cols-7 gap-2"> {/* Jours de la semaine */} {dayNames.map(day => ( <div key={day} className="text-center font-bold text-gray-700 py-2"> {day} </div> ))} {/* Cases vides avant le premier jour */} {Array.from({ length: startingDayOfWeek }).map((_, index) => ( <div key={`empty-${index}`} className="aspect-square"></div> ))} {/* Jours du mois */} {Array.from({ length: daysInMonth }).map((_, index) => { const day = index + 1; const date = new Date(year, month, day); date.setHours(0, 0, 0, 0); const isToday = date.getTime() === today.getTime(); const jobsForDay = getJobsForDate(date); const hasJobs = jobsForDay.length > 0; return ( <div key={day} className={`aspect-square border-2 rounded-lg p-1 md:p-2 ${ isToday ? 'border-blue-600 bg-blue-50' : 'border-gray-200' } ${hasJobs ? 'cursor-pointer hover:shadow-lg' : ''} transition-all`} > <div className="font-bold text-sm md:text-base text-gray-900 mb-1"> {day} </div> {hasJobs && ( <div className="space-y-1"> {jobsForDay.slice(0, 2).map(job => { const isRappel = job.rappel_date && new Date(job.rappel_date).toISOString().split('T')[0] === date.toISOString().split('T')[0]; const isAccepte = job.etat === 'accepte'; return ( <div key={job.id} onClick={() => onViewJob(job)} className={`text-xs p-1 rounded truncate ${ isAccepte ? 'bg-green-200 text-green-900' : isRappel ? 'bg-red-200 text-red-900' : 'bg-blue-200 text-blue-900' } hover:opacity-80`} title={`${job.entreprise} - ${isRappel ? 'Rappel' : 'Candidature'}`} > {job.entreprise} </div> ); })} {jobsForDay.length > 2 && ( <div className="text-xs text-gray-500 text-center"> +{jobsForDay.length - 2} </div> )} </div> )} </div> ); })} </div> </div> </main> </div> ); } 